version: '3.4'

services:

  fit-demo-build:
    image: arcor2/arcor2_build:1.0.2
    container_name: fit-demo-build
    depends_on:
      fit-demo-project:
        condition: service_healthy
    environment:
      - ARCOR2_PROJECT_SERVICE_URL=http://fit-demo-project:10000
      - ARCOR2_PROJECT_PATH=""
      - ARCOR2_BUILD_DEBUG=1
    ports:
      - "5008:5008"
    networks:           
      - fit-demo-project-network

  fit-demo-asset:
    image: registry.gitlab.com/kinalisoft/test-it-off/asset:1.0.0
    container_name: "fit-demo-asset"
    environment:
        - "ASSETS_FOLDER=/tmp/assets"
    volumes:
        - fit-demo-asset:/tmp/assets
    networks:
        - fit-demo-asset-network
    expose:
        - "10040"
    ports:
        - "10040:10040"

  fit-demo-project:
    image: registry.gitlab.com/kinalisoft/test-it-off/project:1.0.1
    container_name: "fit-demo-project"
    ports:
      - "10000-10001:10000-10001"
    environment:
      - "ASSET_SERVICE_URL=http://fit-demo-asset:10040"
    depends_on:
        fit-demo-asset:
          condition: service_healthy
    networks:
      - fit-demo-project-network
      - fit-demo-asset-network

volumes:
  fit-demo-asset:

networks:
  fit-demo-project-network:
  fit-demo-asset-network: